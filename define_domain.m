


%--------------------------------------------------------------------------
% ATTACHED ROUTINES
%--------------------------------------------------------------------------

function [geometry_NURBS_EXT,geometry_NURBS_INT,domain_str]=define_domain(example)

switch example

    case 1

        % DOMAIN S1

        domain_str='domain 13: tau-like-symbol';
        P=[1 0; 0.45 0.37; 1 1; 0 1; -0.8 0.9; -1 0; 0.3 0.5;  ...
            0.2 -0.45; -0.4 -0.4; 0 -1; 1 -1;  1 0];
        order=3;
        L=size(P,1); tt=linspace(0,1,L-order+2);
        ttinit=zeros(1,order); ttmid=tt(2:end-1);  ttfin=ones(1,order);
        knots=[ttinit ttmid ttfin];
        c=1/sqrt(2); w=[1 c c 1 c 1 c 1 c 1 c 1];

        geometry_NURBS_EXT=makeNURBSarc('free','P',...
            P,'knots',knots,'weights',w,'order',order);


        domain_str='S(29):';
        order=3;


        P=[   0.49804687500000   0.23832417582418
            0.52148437500000   0.29601648351648
            0.55507812500000   0.35233516483516
            0.58398437500000   0.40315934065934
            0.58242187500000   0.42513736263736
            0.56757812500000   0.43475274725275
            0.54414062500000   0.41826923076923
            0.52226562500000   0.38942307692308
            0.49570312500000   0.38392857142857
            0.48710937500000   0.41552197802198
            0.48945312500000   0.47184065934066
            0.49882812500000   0.54601648351648
            0.50195312500000   0.62019230769231
            0.49257812500000   0.64766483516484
            0.47773437500000   0.63667582417582
            0.46601562500000   0.55975274725275
            0.45039062500000   0.47733516483516
            0.45273437500000   0.57760989010989
            0.45117187500000   0.65728021978022
            0.43085937500000   0.67788461538462
            0.41757812500000   0.65178571428571
            0.41679687500000   0.57074175824176
            0.41445312500000   0.48008241758242
            0.40195312500000   0.55700549450549
            0.38632812500000   0.63667582417582
            0.37304687500000   0.64766483516484
            0.36210937500000   0.62568681318681
            0.36992187500000   0.53640109890110
            0.37695312500000   0.44848901098901
            0.34492187500000   0.50068681318681
            0.32070312500000   0.54876373626374
            0.30195312500000   0.55151098901099
            0.29882812500000   0.53090659340659
            0.32460937500000   0.45398351648352
            0.34570312500000   0.40041208791209
            0.34960937500000   0.32074175824176
            0.35976562500000   0.23832417582418
            0.49804687500000   0.23832417582418];

        kk=size(P,1)-order;
        knots_mid=linspace(0.1,0.9,kk);
        knots=[0 0 0 knots_mid 1 1 1]; % 12-3
        w=1000*ones(1,size(P,1));

        geometry_NURBS_INT=makeNURBSarc('free','P',...
            P,'knots',knots,'weights',w,'order',order);



    case 2


        % DOMAIN S2

        domain_str='S(4): domain defined by a disk, an ellipse, a segment';
        geometry_NURBS_EXT(1)=makeNURBSarc('disk_arc',...
            'center',[0 0],'angles',[0 2*pi],'radius',3);


        domain_str='domain 13: tau-like-symbol';
        P=[1 0; 0.45 0.37; 1 1; 0 1; -0.8 0.9; -1 0; 0.3 0.5;  ...
            0.2 -0.45; -0.4 -0.4; 0 -1; 1 -1;  1 0];
        order=3;
        L=size(P,1); tt=linspace(0,1,L-order+2);
        ttinit=zeros(1,order); ttmid=tt(2:end-1);  ttfin=ones(1,order);
        knots=[ttinit ttmid ttfin];
        c=1/sqrt(2); w=[1 c c 1 c 1 c 1 c 1 c 1];

        geometry_NURBS_INT=makeNURBSarc('free','P',...
            P,'knots',knots,'weights',w,'order',order);




    case 3


        % DOMAIN S3 (new version)

        domain_str='S(5): domain defined by a disk, an ellipse, a segment';
        geometry_NURBS_EXT(1)=makeNURBSarc('disk_arc',...
            'center',[0 0],'angles',[0 2*pi],'radius',1.5);




        domain_str='minion';
        order=3;
        X=  [2.382466960352423e+01     1.121096916299559e+02
            2.428634361233480e+01     1.190348017621145e+02
            2.659471365638768e+01     1.259599118942731e+02
            2.751806167400883e+01     1.305766519823788e+02
            2.890308370044056e+01     1.351933920704845e+02
            2.936475770925113e+01     1.398101321585902e+02
            2.890308370044056e+01     1.462735682819383e+02
            2.705638766519826e+01     1.508903083700440e+02
            2.613303964757710e+01     1.555070484581497e+02
            2.059295154185023e+01     1.582770925110132e+02
            1.366784140969165e+01     1.610471365638766e+02
            8.589427312775342e+00     1.628938325991189e+02
            3.049339207048462e+00     1.661255506607929e+02
            2.125991189427310e+00     1.730506607929515e+02
            3.972687224669613e+00     1.818224669603524e+02
            9.512775330396494e+00     1.827458149779735e+02
            1.320616740088107e+01     1.841308370044052e+02
            1.505286343612334e+01     1.859775330396475e+02
            1.366784140969165e+01     1.901325991189427e+02
            1.643788546255507e+01     1.915176211453744e+02
            1.551453744493392e+01     1.975193832599118e+02
            1.597621145374450e+01     2.021361233480176e+02
            1.782290748898680e+01     2.049061674008810e+02
            2.151629955947135e+01     2.053678414096916e+02
            2.613303964757710e+01     2.049061674008810e+02
            3.213480176211453e+01     2.049061674008810e+02
            3.675154185022029e+01     2.072145374449339e+02
            3.905991189427311e+01     2.150629955947136e+02
            3.998325991189427e+01     2.229114537444934e+02
            4.182995594713657e+01     2.270665198237885e+02
            4.737004405286342e+01     2.330682819383260e+02
            5.106343612334803e+01     2.358383259911894e+02
            5.660352422907488e+01     2.376850220264317e+02
            5.891189427312776e+01     2.386083700440528e+02
            6.352863436123351e+01     2.399933920704846e+02
            6.445198237885461e+01     2.436867841409691e+02
            6.491365638766518e+01     2.455334801762114e+02
            6.075859030837006e+01     2.483035242290749e+02
            5.845022026431718e+01     2.524585903083700e+02
            5.845022026431718e+01     2.575370044052863e+02
            6.399030837004410e+01     2.598453744493392e+02
            7.322378854625549e+01     2.593837004405286e+02
            7.968722466960355e+01     2.575370044052863e+02
            8.615066079295156e+01     2.575370044052863e+02
            8.984405286343616e+01     2.566136563876652e+02
            8.799735682819386e+01     2.473801762114537e+02
            9.169074889867841e+01     2.450718061674008e+02
            9.169074889867841e+01     2.372233480176211e+02
            9.723083700440533e+01     2.386083700440528e+02
            9.723083700440533e+01     2.404550660792951e+02
            1.000008810572687e+02     2.441484581497797e+02
            1.004625550660793e+02     2.515352422907488e+02
            1.046176211453745e+02     2.566136563876652e+02
            1.120044052863436e+02     2.593837004405286e+02
            1.170828193832599e+02     2.598453744493392e+02
            1.221612334801762e+02     2.598453744493392e+02
            1.304713656387665e+02     2.561519823788546e+02
            1.277013215859031e+02     2.501502202643172e+02
            1.235462555066080e+02     2.464568281938326e+02
            1.244696035242291e+02     2.404550660792951e+02
            1.309330396475771e+02     2.395317180616740e+02
            1.383198237885463e+02     2.376850220264317e+02
            1.452449339207049e+02     2.339916299559471e+02
            1.512466960352423e+02     2.293748898678414e+02
            1.567867841409692e+02     2.229114537444934e+02
            1.590951541850220e+02     2.155246696035242e+02
            1.600185022026432e+02     2.090612334801762e+02
            1.600185022026432e+02     2.021361233480176e+02
            1.600185022026432e+02     1.942876651982378e+02
            1.590951541850220e+02     1.855158590308370e+02
            1.577101321585903e+02     1.758207048458149e+02
            1.577101321585903e+02     1.661255506607929e+02
            1.586334801762115e+02     1.573537444933920e+02
            1.618651982378855e+02     1.439651982378854e+02
            1.650969162995595e+02     1.324233480176211e+02
            1.660202643171806e+02     1.254982378854625e+02
            1.683286343612335e+02     1.176497797356828e+02
            1.701753303964758e+02     1.116480176211453e+02
            1.761770925110132e+02     1.107246696035242e+02
            1.761770925110132e+02     1.010295154185021e+02
            1.812555066079295e+02     9.641277533039641e+01
            1.854105726872247e+02     8.671762114537438e+01
            1.891039647577093e+02     7.840748898678407e+01
            1.881806167400881e+02     7.148237885462549e+01
            1.849488986784141e+02     6.917400881057262e+01
            1.798704845814978e+02     7.148237885462549e+01
            1.784854625550661e+02     6.455726872246692e+01
            1.734070484581498e+02     6.271057268722461e+01
            1.683286343612335e+02     6.501894273127749e+01
            1.660202643171806e+02     7.332907488986780e+01
            1.650969162995595e+02     7.840748898678407e+01
            1.609418502202643e+02     7.102070484581492e+01
            1.554017621145375e+02     7.148237885462549e+01
            1.521700440528634e+02     7.471409691629952e+01
            1.540167400881057e+02     8.163920704845810e+01
            1.558634361233480e+02     8.764096916299553e+01
            1.595568281938326e+02     9.271938325991184e+01
            1.609418502202643e+02     9.825947136563872e+01
            1.572484581497798e+02     1.033378854625550e+02
            1.595568281938326e+02     1.065696035242290e+02
            1.581718061674009e+02     1.139563876651982e+02
            1.563251101321586e+02     1.190348017621145e+02
            1.544784140969163e+02     1.250365638766519e+02
            1.507850220264317e+02     1.125713656387665e+02
            1.484766519823789e+02     1.070312775330396e+02
            1.470916299559472e+02     1.001061674008810e+02
            1.457066079295154e+02     9.133436123348014e+01
            1.438599118942731e+02     8.440925110132153e+01
            1.429365638766520e+02     7.886916299559465e+01
            1.424748898678414e+02     7.286740088105724e+01
            1.447832599118943e+02     7.148237885462549e+01
            1.424748898678414e+02     6.455726872246692e+01
            1.420132158590308e+02     5.947885462555061e+01
            1.401665198237886e+02     5.624713656387661e+01
            1.369348017621145e+02     5.070704845814973e+01
            1.332414096916299e+02     4.285859030836997e+01
            1.309330396475771e+02     4.055022026431711e+01
            1.277013215859031e+02     3.824185022026427e+01
            1.249312775330396e+02     3.454845814977966e+01
            1.263162995594714e+02     3.316343612334796e+01
            1.290863436123348e+02     3.224008810572681e+01
            1.341647577092511e+02     2.947004405286339e+01
            1.360114537444934e+02     2.854669603524223e+01
            1.300096916299560e+02     2.854669603524223e+01
            1.244696035242291e+02     3.131674008810566e+01
            1.216995594713656e+02     3.131674008810566e+01
            1.226229074889868e+02     2.808502202643166e+01
            1.267779735682819e+02     2.531497797356820e+01
            1.309330396475771e+02     2.392995594713651e+01
            1.235462555066080e+02     2.531497797356820e+01
            1.166211453744493e+02     2.762334801762108e+01
            1.152361233480177e+02     2.669999999999993e+01
            1.193911894273128e+02     2.300660792951535e+01
            1.235462555066080e+02     1.931321585903078e+01
            1.300096916299560e+02     1.792819383259905e+01
            1.364731277533040e+02     1.746651982378847e+01
            1.309330396475771e+02     1.654317180616732e+01
            1.226229074889868e+02     1.746651982378847e+01
            1.133894273127754e+02     2.023656387665193e+01
            1.092343612334802e+02     2.115991189427308e+01
            1.032325991189427e+02     2.023656387665193e+01
            1.060026431718062e+02     1.377312775330390e+01
            1.138511013215859e+02     8.233039647577016e+00
            1.166211453744493e+02     4.539647577092467e+00
            1.078493392070484e+02     8.694713656387592e+00
            1.018475770925110e+02     1.469647577092505e+01
            1.013859030837004e+02     1.885154185022020e+01
            9.492246696035244e+01     1.977488986784135e+01
            9.353744493392071e+01     1.331145374449332e+01
            9.584581497797359e+01     4.077973568281891e+00
            9.492246696035244e+01    -1.462114537445018e+00
            9.030572687224668e+01     6.848017621145318e+00
            8.892070484581501e+01     1.238810572687220e+01
            8.845903083700443e+01     1.654317180616732e+01
            8.245726872246695e+01     1.838986784140963e+01
            7.922555066079298e+01     1.654317180616732e+01
            7.968722466960355e+01     9.618061674008743e+00
            8.061057268722470e+01     1.307929515418436e+00
            7.691718061674010e+01     3.616299559471315e+00
            7.691718061674010e+01     9.618061674008743e+00
            7.507048458149779e+01     1.654317180616732e+01
            7.368546255506607e+01     1.746651982378847e+01
            6.768370044052864e+01     1.885154185022020e+01
            6.168193832599122e+01     2.069823788546250e+01
            5.660352422907488e+01     1.700484581497790e+01
            5.106343612334803e+01     1.331145374449332e+01
            4.367665198237887e+01     1.100308370044047e+01
            3.952158590308369e+01     1.192643171806162e+01
            4.460000000000002e+01     1.469647577092505e+01
            5.014008810572687e+01     1.746651982378847e+01
            5.291013215859033e+01     2.254493392070478e+01
            4.783171806167400e+01     2.808502202643166e+01
            4.136828193832599e+01     3.131674008810566e+01
            3.490484581497799e+01     3.177841409691624e+01
            2.797973568281941e+01     2.623832599118936e+01
            1.782290748898680e+01     2.947004405286339e+01
            2.336299559471365e+01     3.131674008810566e+01
            3.167312775330396e+01     3.362511013215852e+01
            3.351982378854626e+01     3.731850220264312e+01
            2.705638766519826e+01     4.101189427312769e+01
            1.689955947136565e+01     3.685682819383254e+01
            9.512775330396494e+00     3.962687224669600e+01
            9.512775330396494e+00     4.378193832599112e+01
            2.013127753303965e+01     4.147356828193827e+01
            2.428634361233480e+01     4.470528634361227e+01
            2.474801762114538e+01     4.562863436123342e+01
            2.151629955947135e+01     5.163039647577085e+01
            2.059295154185023e+01     5.809383259911888e+01
            1.966960352422907e+01     6.409559471365634e+01
            1.736123348017622e+01     7.194405286343607e+01
            1.736123348017622e+01     7.886916299559465e+01
            1.459118942731280e+01     8.302422907488983e+01
            1.597621145374450e+01     8.902599118942726e+01
            1.597621145374450e+01     9.364273127753299e+01
            1.689955947136565e+01     9.733612334801757e+01
            2.013127753303965e+01     9.733612334801757e+01
            2.151629955947135e+01     1.024145374449339e+02
            2.382466960352423e+01     1.121096916299559e+02];

        P=-[X; X(1,:)]/max(abs(X(:,1)));
        P=P(1:2:end,:);
        P=[P; P(1,:)];
        P=P+[0.5 0.7];

        kk=size(P,1)-order;
        knots_mid=linspace(0.1,0.9,kk);
        knots=[0 0 0 knots_mid 1 1 1]; % 12-3
        w=1000*ones(1,size(P,1));

        geometry_NURBS_INT=makeNURBSarc('free','P',...
            P,'knots',knots,'weights',w,'order',order);





    case 4

        % DOMAIN S4

        domain_str='S(42): Font N';
        order=3;

        X=[
            -191.0000 -104.0000
            -200.5000 -104.5000
            -209.5000 -105.5000
            -218.5000 -106.5000
            -226.5000 -108.5000
            -235.0000 -110.0000
            -243.5000 -111.5000
            -251.5000 -113.5000
            -258.5000 -116.5000
            -266.5000 -118.5000
            -274.5000 -120.5000
            -281.5000 -123.5000
            -289.0000 -126.0000
            -296.5000 -128.5000
            -303.5000 -131.5000
            -310.5000 -134.5000
            -318.0000 -137.0000
            -325.0000 -140.0000
            -332.0000 -143.0000
            -334.0000 -136.0000
            -334.0000 -126.0000
            -334.0000 -116.0000
            -341.5000 -113.5000
            -351.5000 -113.5000
            -361.5000 -113.5000
            -371.5000 -113.5000
            -381.5000 -113.5000
            -391.5000 -113.5000
            -401.5000 -113.5000
            -411.5000 -113.5000
            -421.5000 -113.5000
            -431.5000 -113.5000
            -441.5000 -113.5000
            -451.5000 -113.5000
            -461.5000 -113.5000
            -471.5000 -113.5000
            -478.0000 -117.0000
            -477.0000 -126.0000
            -468.5000 -127.5000
            -459.5000 -128.5000
            -450.5000 -129.5000
            -441.5000 -130.5000
            -434.0000 -133.0000
            -427.0000 -136.0000
            -421.0000 -140.0000
            -416.0000 -145.0000
            -412.0000 -151.0000
            -409.0000 -158.0000
            -407.0000 -166.0000
            -407.0000 -176.0000
            -406.0000 -185.0000
            -406.0000 -195.0000
            -406.0000 -205.0000
            -406.0000 -215.0000
            -406.0000 -225.0000
            -406.0000 -235.0000
            -406.0000 -245.0000
            -406.0000 -255.0000
            -406.0000 -265.0000
            -406.0000 -275.0000
            -406.0000 -285.0000
            -406.0000 -295.0000
            -406.0000 -305.0000
            -406.0000 -315.0000
            -406.0000 -325.0000
            -406.0000 -335.0000
            -406.0000 -345.0000
            -406.0000 -355.0000
            -406.0000 -365.0000
            -406.0000 -375.0000
            -406.0000 -385.0000
            -406.0000 -395.0000
            -406.0000 -405.0000
            -406.0000 -415.0000
            -406.0000 -425.0000
            -406.0000 -435.0000
            -406.0000 -445.0000
            -406.0000 -455.0000
            -406.0000 -465.0000
            -406.0000 -475.0000
            -406.0000 -485.0000
            -406.0000 -495.0000
            -406.0000 -505.0000
            -406.0000 -515.0000
            -406.0000 -525.0000
            -406.0000 -535.0000
            -406.5000 -544.5000
            -407.0000 -554.0000
            -408.0000 -563.0000
            -410.0000 -571.0000
            -413.0000 -578.0000
            -417.5000 -583.5000
            -423.0000 -588.0000
            -429.5000 -591.5000
            -436.5000 -594.5000
            -444.5000 -596.5000
            -453.0000 -598.0000
            -462.5000 -598.5000
            -471.5000 -599.5000
            -478.0000 -603.0000
            -477.0000 -612.0000
            -468.5000 -613.5000
            -458.5000 -613.5000
            -448.5000 -613.5000
            -438.5000 -613.5000
            -428.5000 -613.5000
            -418.5000 -613.5000
            -408.5000 -613.5000
            -398.5000 -613.5000
            -388.5000 -613.5000
            -378.5000 -613.5000
            -368.5000 -613.5000
            -358.5000 -613.5000
            -348.5000 -613.5000
            -338.5000 -613.5000
            -328.5000 -613.5000
            -318.5000 -613.5000
            -308.5000 -613.5000
            -298.5000 -613.5000
            -288.5000 -613.5000
            -278.5000 -613.5000
            -268.5000 -613.5000
            -262.0000 -610.0000
            -263.0000 -601.0000
            -271.5000 -599.5000
            -280.5000 -598.5000
            -289.5000 -597.5000
            -297.5000 -595.5000
            -305.0000 -593.0000
            -311.5000 -589.5000
            -318.0000 -586.0000
            -323.0000 -581.0000
            -327.0000 -575.0000
            -330.5000 -568.5000
            -333.0000 -561.0000
            -333.0000 -551.0000
            -334.0000 -542.0000
            -334.0000 -532.0000
            -334.0000 -522.0000
            -334.0000 -512.0000
            -334.0000 -502.0000
            -334.0000 -492.0000
            -334.0000 -482.0000
            -334.0000 -472.0000
            -334.0000 -462.0000
            -334.0000 -452.0000
            -334.0000 -442.0000
            -334.0000 -432.0000
            -334.0000 -422.0000
            -334.0000 -412.0000
            -334.0000 -402.0000
            -334.0000 -392.0000
            -334.0000 -382.0000
            -334.0000 -372.0000
            -334.0000 -362.0000
            -334.0000 -352.0000
            -334.0000 -342.0000
            -334.0000 -332.0000
            -334.0000 -322.0000
            -334.0000 -312.0000
            -334.0000 -302.0000
            -334.0000 -292.0000
            -334.0000 -282.0000
            -334.0000 -272.0000
            -334.0000 -262.0000
            -334.0000 -252.0000
            -334.0000 -242.0000
            -334.0000 -232.0000
            -334.0000 -222.0000
            -334.0000 -212.0000
            -334.0000 -202.0000
            -334.0000 -192.0000
            -334.0000 -182.0000
            -332.0000 -174.0000
            -325.0000 -171.0000
            -317.5000 -168.5000
            -310.5000 -165.5000
            -303.5000 -162.5000
            -295.5000 -160.5000
            -288.5000 -157.5000
            -280.5000 -155.5000
            -272.5000 -153.5000
            -264.5000 -151.5000
            -256.5000 -149.5000
            -247.5000 -148.5000
            -239.5000 -146.5000
            -229.5000 -146.5000
            -220.5000 -145.5000
            -210.5000 -145.5000
            -201.5000 -146.5000
            -192.5000 -147.5000
            -185.0000 -150.0000
            -177.5000 -152.5000
            -171.5000 -156.5000
            -166.0000 -161.0000
            -161.0000 -166.0000
            -157.0000 -172.0000
            -153.0000 -178.0000
            -150.0000 -185.0000
            -148.0000 -193.0000
            -146.0000 -201.0000
            -145.0000 -210.0000
            -145.0000 -220.0000
            -144.0000 -229.0000
            -144.0000 -239.0000
            -144.0000 -249.0000
            -144.0000 -259.0000
            -144.0000 -269.0000
            -144.0000 -279.0000
            -144.0000 -289.0000
            -144.0000 -299.0000
            -144.0000 -309.0000
            -144.0000 -319.0000
            -144.0000 -329.0000
            -144.0000 -339.0000
            -144.0000 -349.0000
            -144.0000 -359.0000
            -144.0000 -369.0000
            -144.0000 -379.0000
            -144.0000 -389.0000
            -144.0000 -399.0000
            -144.0000 -409.0000
            -144.0000 -419.0000
            -144.0000 -429.0000
            -144.0000 -439.0000
            -144.0000 -449.0000
            -144.0000 -459.0000
            -144.0000 -469.0000
            -144.0000 -479.0000
            -144.0000 -489.0000
            -144.0000 -499.0000
            -144.0000 -509.0000
            -144.0000 -519.0000
            -144.0000 -529.0000
            -144.0000 -539.0000
            -144.0000 -549.0000
            -144.0000 -559.0000
            -144.0000 -569.0000
            -144.0000 -579.0000
            -144.0000 -589.0000
            -144.0000 -599.0000
            -144.0000 -609.0000
            -144.0000 -619.0000
            -144.0000 -629.0000
            -144.0000 -639.0000
            -144.0000 -649.0000
            -144.0000 -659.0000
            -144.0000 -669.0000
            -144.0000 -679.0000
            -144.0000 -689.0000
            -144.0000 -699.0000
            -145.0000 -708.0000
            -145.0000 -718.0000
            -147.0000 -726.0000
            -149.0000 -734.0000
            -152.5000 -740.5000
            -157.0000 -746.0000
            -163.0000 -750.0000
            -170.0000 -753.0000
            -177.5000 -755.5000
            -185.5000 -757.5000
            -194.5000 -758.5000
            -203.5000 -759.5000
            -213.5000 -759.5000
            -216.0000 -767.0000
            -212.5000 -773.5000
            -202.5000 -773.5000
            -192.5000 -773.5000
            -182.5000 -773.5000
            -172.5000 -773.5000
            -162.5000 -773.5000
            -152.5000 -773.5000
            -142.5000 -773.5000
            -132.5000 -773.5000
            -122.5000 -773.5000
            -112.5000 -773.5000
            -102.5000 -773.5000
            -92.5000 -773.5000
            -82.5000 -773.5000
            -72.5000 -773.5000
            -62.5000 -773.5000
            -52.5000 -773.5000
            -42.5000 -773.5000
            -32.5000 -773.5000
            -22.5000 -773.5000
            -12.5000 -773.5000
            -2.5000 -773.5000
            0 -766.0000
            -3.5000 -759.5000
            -13.0000 -759.0000
            -22.5000 -758.5000
            -30.5000 -756.5000
            -38.5000 -754.5000
            -45.5000 -751.5000
            -52.0000 -748.0000
            -58.0000 -744.0000
            -63.0000 -739.0000
            -67.0000 -733.0000
            -69.5000 -725.5000
            -71.0000 -717.0000
            -72.0000 -708.0000
            -72.0000 -698.0000
            -72.0000 -688.0000
            -72.0000 -678.0000
            -72.0000 -668.0000
            -72.0000 -658.0000
            -72.0000 -648.0000
            -72.0000 -638.0000
            -72.0000 -628.0000
            -72.0000 -618.0000
            -72.0000 -608.0000
            -72.0000 -598.0000
            -72.0000 -588.0000
            -72.0000 -578.0000
            -72.0000 -568.0000
            -72.0000 -558.0000
            -72.0000 -548.0000
            -72.0000 -538.0000
            -72.0000 -528.0000
            -72.0000 -518.0000
            -72.0000 -508.0000
            -72.0000 -498.0000
            -72.0000 -488.0000
            -72.0000 -478.0000
            -72.0000 -468.0000
            -72.0000 -458.0000
            -72.0000 -448.0000
            -72.0000 -438.0000
            -72.0000 -428.0000
            -72.0000 -418.0000
            -72.0000 -408.0000
            -72.0000 -398.0000
            -72.0000 -388.0000
            -72.0000 -378.0000
            -72.0000 -368.0000
            -72.0000 -358.0000
            -72.0000 -348.0000
            -72.0000 -338.0000
            -72.0000 -328.0000
            -72.0000 -318.0000
            -72.0000 -308.0000
            -72.0000 -298.0000
            -72.0000 -288.0000
            -72.0000 -278.0000
            -72.0000 -268.0000
            -72.0000 -258.0000
            -72.0000 -248.0000
            -72.0000 -238.0000
            -72.0000 -228.0000
            -73.0000 -219.0000
            -73.0000 -211.0000
            -73.0000 -201.0000
            -74.0000 -192.0000
            -74.5000 -182.5000
            -75.5000 -173.5000
            -77.0000 -165.0000
            -79.0000 -157.0000
            -82.5000 -150.5000
            -86.0000 -144.0000
            -90.5000 -138.5000
            -95.5000 -133.5000
            -101.0000 -129.0000
            -106.5000 -124.5000
            -113.0000 -121.0000
            -119.5000 -117.5000
            -126.5000 -114.5000
            -134.0000 -112.0000
            -141.5000 -109.5000
            -149.5000 -107.5000
            -158.5000 -106.5000
            -166.5000 -104.5000
            -176.5000 -104.5000
            -185.5000 -103.5000];



        P=[X; X(1,:)]/max(abs(X(:,1)));
        P=P(1:10:end,:); P(end+1,:)=P(1,:);

        kk=size(P,1)-order;
        knots_mid=linspace(0.1,0.9,kk);
        knots=[0 0 0 knots_mid 1 1 1]; % 12-3
        w=1000*ones(1,size(P,1));

        geometry_NURBS_EXT=makeNURBSarc('free','P',...
            P,'knots',knots,'weights',w,'order',order);




        P=0.12*P-[0.165 0.6];

        kk=size(P,1)-order;
        knots_mid=linspace(0.1,0.9,kk);
        knots=[0 0 0 knots_mid 1 1 1]; % 12-3
        w=1000*ones(1,size(P,1));


        geometry_NURBS_INT=makeNURBSarc('free','P',...
            P,'knots',knots,'weights',w,'order',order);






    case 5

        % DOMAIN S3 (old version)

        domain_str='S(4): domain defined by a disk, an ellipse, a segment';
        geometry_NURBS_EXT(1)=makeNURBSarc('disk_arc',...
            'center',[-0.5 -0.5],'angles',[0 2*pi],'radius',1.5);




        domain_str='minion';
        order=3;
        X=  [2.382466960352423e+01     1.121096916299559e+02
            2.428634361233480e+01     1.190348017621145e+02
            2.659471365638768e+01     1.259599118942731e+02
            2.751806167400883e+01     1.305766519823788e+02
            2.890308370044056e+01     1.351933920704845e+02
            2.936475770925113e+01     1.398101321585902e+02
            2.890308370044056e+01     1.462735682819383e+02
            2.705638766519826e+01     1.508903083700440e+02
            2.613303964757710e+01     1.555070484581497e+02
            2.059295154185023e+01     1.582770925110132e+02
            1.366784140969165e+01     1.610471365638766e+02
            8.589427312775342e+00     1.628938325991189e+02
            3.049339207048462e+00     1.661255506607929e+02
            2.125991189427310e+00     1.730506607929515e+02
            3.972687224669613e+00     1.818224669603524e+02
            9.512775330396494e+00     1.827458149779735e+02
            1.320616740088107e+01     1.841308370044052e+02
            1.505286343612334e+01     1.859775330396475e+02
            1.366784140969165e+01     1.901325991189427e+02
            1.643788546255507e+01     1.915176211453744e+02
            1.551453744493392e+01     1.975193832599118e+02
            1.597621145374450e+01     2.021361233480176e+02
            1.782290748898680e+01     2.049061674008810e+02
            2.151629955947135e+01     2.053678414096916e+02
            2.613303964757710e+01     2.049061674008810e+02
            3.213480176211453e+01     2.049061674008810e+02
            3.675154185022029e+01     2.072145374449339e+02
            3.905991189427311e+01     2.150629955947136e+02
            3.998325991189427e+01     2.229114537444934e+02
            4.182995594713657e+01     2.270665198237885e+02
            4.737004405286342e+01     2.330682819383260e+02
            5.106343612334803e+01     2.358383259911894e+02
            5.660352422907488e+01     2.376850220264317e+02
            5.891189427312776e+01     2.386083700440528e+02
            6.352863436123351e+01     2.399933920704846e+02
            6.445198237885461e+01     2.436867841409691e+02
            6.491365638766518e+01     2.455334801762114e+02
            6.075859030837006e+01     2.483035242290749e+02
            5.845022026431718e+01     2.524585903083700e+02
            5.845022026431718e+01     2.575370044052863e+02
            6.399030837004410e+01     2.598453744493392e+02
            7.322378854625549e+01     2.593837004405286e+02
            7.968722466960355e+01     2.575370044052863e+02
            8.615066079295156e+01     2.575370044052863e+02
            8.984405286343616e+01     2.566136563876652e+02
            8.799735682819386e+01     2.473801762114537e+02
            9.169074889867841e+01     2.450718061674008e+02
            9.169074889867841e+01     2.372233480176211e+02
            9.723083700440533e+01     2.386083700440528e+02
            9.723083700440533e+01     2.404550660792951e+02
            1.000008810572687e+02     2.441484581497797e+02
            1.004625550660793e+02     2.515352422907488e+02
            1.046176211453745e+02     2.566136563876652e+02
            1.120044052863436e+02     2.593837004405286e+02
            1.170828193832599e+02     2.598453744493392e+02
            1.221612334801762e+02     2.598453744493392e+02
            1.304713656387665e+02     2.561519823788546e+02
            1.277013215859031e+02     2.501502202643172e+02
            1.235462555066080e+02     2.464568281938326e+02
            1.244696035242291e+02     2.404550660792951e+02
            1.309330396475771e+02     2.395317180616740e+02
            1.383198237885463e+02     2.376850220264317e+02
            1.452449339207049e+02     2.339916299559471e+02
            1.512466960352423e+02     2.293748898678414e+02
            1.567867841409692e+02     2.229114537444934e+02
            1.590951541850220e+02     2.155246696035242e+02
            1.600185022026432e+02     2.090612334801762e+02
            1.600185022026432e+02     2.021361233480176e+02
            1.600185022026432e+02     1.942876651982378e+02
            1.590951541850220e+02     1.855158590308370e+02
            1.577101321585903e+02     1.758207048458149e+02
            1.577101321585903e+02     1.661255506607929e+02
            1.586334801762115e+02     1.573537444933920e+02
            1.618651982378855e+02     1.439651982378854e+02
            1.650969162995595e+02     1.324233480176211e+02
            1.660202643171806e+02     1.254982378854625e+02
            1.683286343612335e+02     1.176497797356828e+02
            1.701753303964758e+02     1.116480176211453e+02
            1.761770925110132e+02     1.107246696035242e+02
            1.761770925110132e+02     1.010295154185021e+02
            1.812555066079295e+02     9.641277533039641e+01
            1.854105726872247e+02     8.671762114537438e+01
            1.891039647577093e+02     7.840748898678407e+01
            1.881806167400881e+02     7.148237885462549e+01
            1.849488986784141e+02     6.917400881057262e+01
            1.798704845814978e+02     7.148237885462549e+01
            1.784854625550661e+02     6.455726872246692e+01
            1.734070484581498e+02     6.271057268722461e+01
            1.683286343612335e+02     6.501894273127749e+01
            1.660202643171806e+02     7.332907488986780e+01
            1.650969162995595e+02     7.840748898678407e+01
            1.609418502202643e+02     7.102070484581492e+01
            1.554017621145375e+02     7.148237885462549e+01
            1.521700440528634e+02     7.471409691629952e+01
            1.540167400881057e+02     8.163920704845810e+01
            1.558634361233480e+02     8.764096916299553e+01
            1.595568281938326e+02     9.271938325991184e+01
            1.609418502202643e+02     9.825947136563872e+01
            1.572484581497798e+02     1.033378854625550e+02
            1.595568281938326e+02     1.065696035242290e+02
            1.581718061674009e+02     1.139563876651982e+02
            1.563251101321586e+02     1.190348017621145e+02
            1.544784140969163e+02     1.250365638766519e+02
            1.507850220264317e+02     1.125713656387665e+02
            1.484766519823789e+02     1.070312775330396e+02
            1.470916299559472e+02     1.001061674008810e+02
            1.457066079295154e+02     9.133436123348014e+01
            1.438599118942731e+02     8.440925110132153e+01
            1.429365638766520e+02     7.886916299559465e+01
            1.424748898678414e+02     7.286740088105724e+01
            1.447832599118943e+02     7.148237885462549e+01
            1.424748898678414e+02     6.455726872246692e+01
            1.420132158590308e+02     5.947885462555061e+01
            1.401665198237886e+02     5.624713656387661e+01
            1.369348017621145e+02     5.070704845814973e+01
            1.332414096916299e+02     4.285859030836997e+01
            1.309330396475771e+02     4.055022026431711e+01
            1.277013215859031e+02     3.824185022026427e+01
            1.249312775330396e+02     3.454845814977966e+01
            1.263162995594714e+02     3.316343612334796e+01
            1.290863436123348e+02     3.224008810572681e+01
            1.341647577092511e+02     2.947004405286339e+01
            1.360114537444934e+02     2.854669603524223e+01
            1.300096916299560e+02     2.854669603524223e+01
            1.244696035242291e+02     3.131674008810566e+01
            1.216995594713656e+02     3.131674008810566e+01
            1.226229074889868e+02     2.808502202643166e+01
            1.267779735682819e+02     2.531497797356820e+01
            1.309330396475771e+02     2.392995594713651e+01
            1.235462555066080e+02     2.531497797356820e+01
            1.166211453744493e+02     2.762334801762108e+01
            1.152361233480177e+02     2.669999999999993e+01
            1.193911894273128e+02     2.300660792951535e+01
            1.235462555066080e+02     1.931321585903078e+01
            1.300096916299560e+02     1.792819383259905e+01
            1.364731277533040e+02     1.746651982378847e+01
            1.309330396475771e+02     1.654317180616732e+01
            1.226229074889868e+02     1.746651982378847e+01
            1.133894273127754e+02     2.023656387665193e+01
            1.092343612334802e+02     2.115991189427308e+01
            1.032325991189427e+02     2.023656387665193e+01
            1.060026431718062e+02     1.377312775330390e+01
            1.138511013215859e+02     8.233039647577016e+00
            1.166211453744493e+02     4.539647577092467e+00
            1.078493392070484e+02     8.694713656387592e+00
            1.018475770925110e+02     1.469647577092505e+01
            1.013859030837004e+02     1.885154185022020e+01
            9.492246696035244e+01     1.977488986784135e+01
            9.353744493392071e+01     1.331145374449332e+01
            9.584581497797359e+01     4.077973568281891e+00
            9.492246696035244e+01    -1.462114537445018e+00
            9.030572687224668e+01     6.848017621145318e+00
            8.892070484581501e+01     1.238810572687220e+01
            8.845903083700443e+01     1.654317180616732e+01
            8.245726872246695e+01     1.838986784140963e+01
            7.922555066079298e+01     1.654317180616732e+01
            7.968722466960355e+01     9.618061674008743e+00
            8.061057268722470e+01     1.307929515418436e+00
            7.691718061674010e+01     3.616299559471315e+00
            7.691718061674010e+01     9.618061674008743e+00
            7.507048458149779e+01     1.654317180616732e+01
            7.368546255506607e+01     1.746651982378847e+01
            6.768370044052864e+01     1.885154185022020e+01
            6.168193832599122e+01     2.069823788546250e+01
            5.660352422907488e+01     1.700484581497790e+01
            5.106343612334803e+01     1.331145374449332e+01
            4.367665198237887e+01     1.100308370044047e+01
            3.952158590308369e+01     1.192643171806162e+01
            4.460000000000002e+01     1.469647577092505e+01
            5.014008810572687e+01     1.746651982378847e+01
            5.291013215859033e+01     2.254493392070478e+01
            4.783171806167400e+01     2.808502202643166e+01
            4.136828193832599e+01     3.131674008810566e+01
            3.490484581497799e+01     3.177841409691624e+01
            2.797973568281941e+01     2.623832599118936e+01
            1.782290748898680e+01     2.947004405286339e+01
            2.336299559471365e+01     3.131674008810566e+01
            3.167312775330396e+01     3.362511013215852e+01
            3.351982378854626e+01     3.731850220264312e+01
            2.705638766519826e+01     4.101189427312769e+01
            1.689955947136565e+01     3.685682819383254e+01
            9.512775330396494e+00     3.962687224669600e+01
            9.512775330396494e+00     4.378193832599112e+01
            2.013127753303965e+01     4.147356828193827e+01
            2.428634361233480e+01     4.470528634361227e+01
            2.474801762114538e+01     4.562863436123342e+01
            2.151629955947135e+01     5.163039647577085e+01
            2.059295154185023e+01     5.809383259911888e+01
            1.966960352422907e+01     6.409559471365634e+01
            1.736123348017622e+01     7.194405286343607e+01
            1.736123348017622e+01     7.886916299559465e+01
            1.459118942731280e+01     8.302422907488983e+01
            1.597621145374450e+01     8.902599118942726e+01
            1.597621145374450e+01     9.364273127753299e+01
            1.689955947136565e+01     9.733612334801757e+01
            2.013127753303965e+01     9.733612334801757e+01
            2.151629955947135e+01     1.024145374449339e+02
            2.382466960352423e+01     1.121096916299559e+02];

        P=-[X; X(1,:)]/max(abs(X(:,1)));
        P=P(1:2:end,:);
        P=[P; P(1,:)];

        kk=size(P,1)-order;
        knots_mid=linspace(0.1,0.9,kk);
        knots=[0 0 0 knots_mid 1 1 1]; % 12-3
        w=1000*ones(1,size(P,1));

        geometry_NURBS_INT=makeNURBSarc('free','P',...
            P,'knots',knots,'weights',w,'order',order);














end
